function Calendar(t,e,n,a,r,l,i){this.language=a||1,this.patternDelimiter=r||"-",this.date2StringPattern=l||Calendar.language.date2StringPattern[this.language].replace(/\-/g,this.patternDelimiter),this.string2DatePattern=i||Calendar.language.string2DatePattern[this.language],this.dateControl=null,this.div=t,this.selected=e,this.date=new Date(n),this.year=this.date.getFullYear(),this.month=this.date.getMonth()}Calendar.language={year:["年","","","年"],months:[["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]],weeks:[["日","一","二","三","四","五","六"],["Sun","Mon","Tur","Wed","Thu","Fri","Sat"],["Sun","Mon","Tur","Wed","Thu","Fri","Sat"],["日","一","二","三","四","五","六"]],clear:["清空","Clear","Clear","清空"],today:["今天","Today","Today","今天"],close:["关闭","Close","Close","關閉"],date2StringPattern:["yyyy-MM-dd","yyyy-MM-dd","yyyy-MM-dd","yyyy-MM-dd"],string2DatePattern:["ymd","ymd","ymd","ymd"]},Calendar.prototype.draw=function(){calendar=this;var t=[];t[t.length]='<table id="__calendarTable" border="0" cellpadding="0" cellspacing="0" class="month">',t[t.length]=" <tr>";for(var e=["sun","mon","tue","wed","thu","fri","sat"],n=0;7>n;n++)t[t.length]='<th class="'+e[n]+'">',t[t.length]=Calendar.language.weeks[this.language][n],t[t.length]="</th>";t[t.length]="</tr>";for(var n=0;6>n;n++){t[t.length]='<tr align="center">';for(var a=0;7>a;a++)t[t.length]='<td class="'+e[a]+'">&nbsp;</td>';t[t.length]="</tr>"}t[t.length]="</table>",this.div.innerHTML=t.join("")},Calendar.prototype.bindData=function(){for(var t=this.getMonthViewDateArray(this.date.getFullYear(),this.date.getMonth()),e=this.getElementsByTagName("td",this.getElementById("__calendarTable")),n=0;n<e.length;n++)if(e[n].onclick=null,e[n].onmouseover=null,e[n].onmouseout=null,void 0==t[n]?e[n].innerHTML='<div class="cell undo"></div>':e[n].innerHTML='<div class="cell">'+t[n]+"</div>"||"&nbsp;",!(n>t.length-1)&&t[n])for(var a in this.selected)this.selected[a]==t[n]&&(e[n].innerHTML='<div class="cell done">'+t[n]+"</div>"||"&nbsp;")},Calendar.prototype.getMonthViewDateArray=function(t,e){for(var n=new Array(42),a=new Date(t,e,1).getDay(),r=new Date(t,e+1,0).getDate(),l=0;r>l;l++)n[l+a]=l+1;return n},Calendar.prototype.show=function(t,e){this.draw(),this.bindData()},Calendar.prototype.getElementById=function(t,e){return e=e||document,document.getElementById?e.getElementById(t):document.all(t)},Calendar.prototype.getElementsByTagName=function(t,e){return e=e||document,document.getElementsByTagName?e.getElementsByTagName(t):document.all.tags(t)},Date.prototype.format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"w+":"日一二三四五六".charAt(this.getDay()),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in e)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[n]:("00"+e[n]).substr((""+e[n]).length)));return t},String.prototype.toDate=function(t,e){t=t||"-",e=e||"ymd";var n=this.split(t),a=parseInt(n[e.indexOf("y")],10);a.toString().length<=2&&(a+=2e3),isNaN(a)&&(a=(new Date).getFullYear());var r=parseInt(n[e.indexOf("m")],10)-1,l=parseInt(n[e.indexOf("d")],10);return isNaN(l)&&(l=1),new Date(a,r,l)};